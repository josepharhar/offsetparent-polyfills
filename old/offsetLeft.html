<!DOCTYPE html>

<div id=one style="position:relative; top:2px; left:2px">
  <template shadowroot=open>
    <div id=two style="position:relative; top:5px; left:5px">
      <template shadowroot=open>
        <div id=three style="position:relative; top:10px; left:10px">
          <template shadowroot=open>
            <div id=four style="position:relative; top:20px; left:20px">
              <slot></slot>
            </div>
          </template>
          <slot></slot>
        </div>
      </template>
      <div id=slotted>hello world</div>
    </div>
  </template>
</div>

<script>
(function attachShadowRoots(root) {
  root.querySelectorAll("template[shadowroot]").forEach(template => {
    const mode = template.getAttribute("shadowroot");
    const shadowRoot = template.parentNode.attachShadow({ mode });
    shadowRoot.appendChild(template.content);
    template.remove();
    attachShadowRoots(shadowRoot);
  });
})(document);
</script>

<br><br><br>
<div id=output></div>
<script>
  const slotted = one.shadowRoot.getElementById('slotted');
  function log(str) {
    output.insertAdjacentHTML('beforeend', `<div>${str}</div>`);
  }
  log('slotted offsetParent: ' + slotted.offsetParent.id);
  log('slotted offsetTop: ' + slotted.offsetTop);
  log('slotted offsetLeft: ' + slotted.offsetLeft);
  log('slotted getRootNode.host: ' + slotted.getRootNode().host.id);
</script>
